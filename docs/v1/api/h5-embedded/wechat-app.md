# 微信小程序嵌入H5 页面说明文档

## 功能介绍
---
本文档介绍如何在微信小程序中嵌入宠物智灵提供的H5页面服务。通过嵌入H5页面，用户的微信小程序可以快速集成宠物智灵提供的各种宠物健康服务，如宠物品种识别、宠物情绪识别、宠物健康检测等功能，无需自行开发这些复杂功能，大大节省开发时间和成本。

## 实现方式
---
实现方式是通过微信小程序的web-view组件加载宠物智灵提供的H5页面URL，并传递必要的参数（如access_token和宠物ID）。由于微信小程序对web-view有严格的域名限制，文档详细说明了如何配置业务域名以及验证文件的上传步骤，确保开发者能够顺利完成集成。

## 使用场景
---
- **宠物服务小程序功能扩展**：为您的宠物服务小程序增加专业的宠物健康检测功能
- **宠物电商小程序增值**：在宠物电商小程序中提供宠物健康服务，增加用户粘性
- **宠物社区小程序互动增强**：为宠物社区小程序增加更多互动功能和专业服务
- **宠物医疗小程序功能补充**：为宠物医疗小程序提供更多AI辅助诊断功能

---
接入微信小程序，开发者需要按照如下步骤完成：

### 第一步：填写微信小程序业务域名配置
1. 登录微信小程序后台
- 打开浏览器，访问微信小程序后台网址：https://mp.weixin.qq.com。
- 输入你的微信开发者账号和密码进行登录或者扫码登录。

2. 进入开发管理
- 登录成功后，在左侧菜单中找到并点击 ` 开发管理 ` 选项。

3. 访问开发设置
- 在 ` 开发管理 ` 页面中，选择 ` 开发设置 `选项。

4. 配置业务域名
- 在 ` 开发设置 ` 页面中，找到 ` 服务器域名 ` 部分。
- 点击 `新增` 按钮，开始配置业务域名。

5. 输入业务域名
- 在弹出的配置窗口中，输入需要配置的业务域名：`h5.chongzhiling.com `。

6. 上传验证文件（必需）
- 根据微信的webview要求，需要下载一个验证文件，并联系服务商配置服务器证书，上传到服务商域名服务器的指定目录，以便微信后台能够验证域名的权限。

7. 提交并保存
- 完成域名配置后，点击 "提交" 或 "保存" 按钮

8. 注意事项
- 目前小程序内嵌网页能力暂不开放给个人类型账号和小游戏账号，确保你的账号类型符合配置业务域名的要求。

### 第二步：进入开发阶段
1. 获取商户登录凭证：`access_token` 来鉴权调用者身份。（已有忽略）

2. 登录商家后台，获取服务嵌入链接地址。

3. 在小程序项目中新增一个页面，并在页面中使用如下代码：
```html
<template>
    <view>
        <!-- 商家后台获取的嵌入链接地址，示例： -->
        <web-view src="https://h5.chongzhiling.com?access_token=[登录凭证]&petId=[宠物Id]" />
    </view>
</template>
```

**链接地址参数说明：**
| 参数         | 类型   | 含义     |
| ------------ | ------ | -------- |
| access_token | string | 登录凭证 |
| petId        | number | 宠物ID   |

**注意:**

- petId不传入该字段时，如果用户没有新建过宠物档案，我们将会在嵌入页面中先跳转新建宠物档案的入口。

- 如果商家需要自带用户的宠物信息，可以通过putId该字段进行传入。但请注意，前提是必须先调用宠物档案API的接口。用户在商户小程序中新建宠物档案时，顺带将宠物部分信息存入我们的数据库，我们才能获取传入的宠物ID的信息。